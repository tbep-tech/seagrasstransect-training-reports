--- 
title: '`r paste(params$yr, "transect training report:", params$grpnoyr)`'
format: 
  dashboard:
    embed-resources: true
    logo: images/tarponlogo.png
    nav-buttons: [github]
    css: styles.css
  
params:
  yr: yr
  grp: grp
  grpnoyr: grpnoyr
  transect: transect
  truvar: truvar
  grpscr: grpscr
  allgrpscr: allgrpscr
  scrsum: scrsum
  
execute:
  echo: false
  warning: false
  message: false
---

```{r}
source(here::here('R/funcs.R'))
load(file = here::here('data/trndat.rda'))

yr <- params$yr
grp <- params$grp
grpnoyr <- params$grpnoyr
transect <- params$transect
truvar <- data.frame(params$truvar)
grpscr <- tibble::as_tibble(params$grpscr) # do not use as.data.frame, names get coerced
allgrpscr <- tibble::as_tibble(params$allgrpscr)
scrsum <- params$scrsum

evalgrp <- evalgrp_fun(trndat, yr, grp, truvar)

cards <- purrr::map(
  c('Abundance', 'Blade Length', 'Short Shoot Density'), 
  ~ card_fun(evalgrp, grp, allgrpscr, .x)
  )
```

## Row {height=50%}

### Column {.tabset}

```{r}
#| title: "Overall summary"
gt::html(scrsum)
```
  
```{r}
#| title: "Transect summary"
evaltrntab_fun(evalgrp)
```

## Row {height=50%}

```{r}
bslib::layout_column_wrap(width = '250px', fill = F, cards[[1]], cards[[2]], cards[[3]])
```
